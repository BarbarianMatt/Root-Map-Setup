(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{UYdf:function(t,e,r){"use strict";r.r(e),r.d(e,"InputModule",function(){return P});var n=r("ofXK"),o=r("tyNb"),l=r("6xEa"),i=r("fXoL"),a=r("UPMW"),c=r("BJvs"),s=r("HDMR");function g(t,e){return d(t).slice(0,e)}function h(t,e){return t+e+"\r\n"}function d(t){return null==t&&console.trace(),t.map(t=>({value:t,sort:Math.random()})).sort((t,e)=>t.sort-e.sort).map(({value:t})=>t)}function u(t,e){return Array.from({length:e},(e,r)=>r+t)}function b(t,e,r,n){var o=c.l[n][e];return!(r.includes(e)||"t"!=t&&r.some(t=>o.adjacent.includes(t))||"t"==t&&!o.ruins||"t_m"==t&&(1!=o.slots||o.ruins)||"t_c"==t&&!o.river||"t_f"==t&&!o.river||!("t_r"!=t||!o.edge&&o.adjacent.length>2))}function f(t,e){for(var r=["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"],n=[],o=JSON.parse(JSON.stringify(t)),l=0;l<Math.max(e+1,3);l++){var i=g(o,1)[0];if(n.push(i),o.splice(o.indexOf(i),1),"V"==i){o.push("G");var a=g(r,1)[0];n.push(a),r.splice(r.indexOf(a),1)}else"G"==i&&(a=g(r,1)[0],n.push(a),r.splice(r.indexOf(a),1))}return n}function p(t,e){t.includes(e)&&t.splice(t.indexOf(e),1)}let m=(()=>{class t{constructor(t){this.rootlogService=t}mapSetup(t,e,r,n){var o="";const l=g([a.RootMap.Fall,a.RootMap.Winter,a.RootMap.Lake,a.RootMap.Mountain],1)[0];o=h(o,"Map: "+l);var i=Math.random()<=.9?"E&P":"Standard";o=h(o,"Deck: "+i);var s=["R","R","R","R","F","F","F","F","M","M","M","M"];s=d(s);for(var m=!0;n&&m;){s=d(s),m=!1;for(var v=0;v<s.length;v++){var S=c.l[l][v+1].adjacent;if(l==a.RootMap.Mountain&&(S=S.concat(c.l[l][v+1].closedAdjacent)),S.some(t=>s[t-1]==s[v])){m=!0;break}}}var M="Clearings: "+s[0]+"1";for(v=1;v<s.length;v++)M+=", "+s[v]+(v+1).toString();o=h(o,M);var O="";o=h(o,"M: "+i+" Deck");var w=g(["t","t_m","t_c","t_f","t_k","t_r"],Math.round(Math.max(Math.min(function(t,e){const{z0:r}=function(){const t=Math.random(),e=Math.random();return{z0:Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e),z1:Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*e)}}();return.557*r+1.1}(),2),0))),j=Math.random();("Mountain"==l&&j<.4&&!w.includes("t")||"Lake"==l&&j<.4&&!w.includes("t_f"))&&(w[0]="Mountain"==l?"t":"t_f");for(var _=!1,y=[],C=0;!_&&C<=1e5;){y=[],_=!0,w=d(w);var R=g(u(1,12),w.length);for(v=0;v<w.length;v++){var k=R[v];j=Math.random(),"Mountain"==l&&j<.2&&(k=10),b(w[v],k,y,l)||(_=!1),y.push(k)}C+=1}C>=1e5&&console.log("looped too much");var N=u(1,12).filter(t=>c.l[l][t].ruins),I=["b","b_s","b_w","b_r"],P="M:";if(N.length>0)for(P+=I[0]+"->"+N[0]+"/",v=1;v<N.length;v++)P+=I[v]+"->"+N[v]+"/";if(w.length>0){for(v=0;v<y.length;v++)P+=w[v]+"->"+y[v].toString()+"/","t_c"==w[v]?s[y[v]-1]=s[y[v]-1]+"FRM".replace(s[y[v]-1],""):"t_r"==w[v]?c.l[l][y[v]].slots=c.l[l][y[v]].slots+1:"t_k"==w[v]&&(s[y[v]-1].includes("F")&&(P+="Z%s/Z%s/Z%x/Z%h/"),s[y[v]-1].includes("R")&&(P+="Z%b/Z%b/Z%t/Z%t/"),s[y[v]-1].includes("M")&&(P+="Z%f/Z%f/Z%c/Z%c/"));O=h(O,P=P.slice(0,-1))}var F=["P","L","D","E","C","O","V","A","K","H"],x=["c","e","a","v","p","d","o","l"],U=["\xe5","\u1ea3","\u1ea5","\u1ea7","\u1ea9","\u0203"],L=g(x,e);for(L.push("c"),v=0;v<L.length;v++)p(F,L[v].toUpperCase()),"v"==L[v]&&L.splice(v+1,0,g(U,1)[0]),P=L[v]+": "+this.rootlogService.getFactionProperName(L[v]),x.includes(L[v])&&(P+=" ("+g(c.i[L[v].toUpperCase()],1)+")"),o=h(o,P);var V=u(1,12).filter(t=>c.l[l][t].corner),D=0;if(L.includes("c")){var G=d(["b_s","b_r","b_w"]),Z=g(V,1)[0];for(V.splice(V.indexOf(Z),1),D=Z,P="c:t_k->"+Z.toString()+"/w->"+Z.toString(),v=1;v<13;v++)c.l[l][Z].opposite!=v&&(P+="+"+v.toString());var E=c.l[l][Z].adjacent;for(E.length<G.length&&(E=E.concat(Array(G.length-E.length).fill(Z))),v=0;v<G.length;v++)P+="/"+G[v]+"->"+E[v].toString(),c.l[l][E[v]].slots=c.l[l][E[v]].slots-1;O=h(O,P)}if(L.includes("e")&&(Z=3==V.length?c.l[l][u(1,12).filter(t=>c.l[l][t].corner&&!V.includes(t))[0]].opposite:g(V,1)[0],V.splice(V.indexOf(Z),1),c.l[l][Z].slots=c.l[l][Z].slots-1,O=h(O,"e:b+6w->"+Z.toString())),L.includes("v")){var J=Object.keys(c.j[l]).reduce((t,e)=>t>(e.match(/\_/g)||[]).length?t:(e.match(/\_/g)||[]).length,0);O=h(O,"v:p->"+g(Object.keys(c.j[l]).filter(t=>(t.match(/\_/g)||[]).length==J),1)[0].toString())}if(L.includes("l")){for(Z=3==V.length?c.l[l][u(1,12).filter(t=>c.l[l][t].corner&&!V.includes(t))[0]].opposite:g(V,1)[0],V.splice(V.indexOf(Z),1),P="l:4w+b_"+s[Z-1].toString()[0].toLowerCase()+"->"+Z.toString(),v=0;v<c.l[l][Z].adjacent.length;v++)P+="/w->"+c.l[l][Z].adjacent[v].toString();c.l[l][Z].slots=c.l[l][Z].slots-1,O=h(O,P)}if(L.includes("o")){for(P="o:w->"+(W=u(1,12).filter(t=>c.l[l][t].river&&t!=D))[0],v=1;v<W.length;v++)P+="+"+W[v];O=h(O,P)}if(L.includes("d")){for(Z=3==V.length?c.l[l][u(1,12).filter(t=>c.l[l][t].corner&&!V.includes(t))[0]].opposite:g(V,1)[0],V.splice(V.indexOf(Z),1),P="d:t->"+Z.toString()+"/2w->"+Z.toString(),v=0;v<c.l[l][Z].adjacent.length;v++)P+="+"+c.l[l][Z].adjacent[v].toString();O=h(O,P)}L.includes("p")&&(P="p:w->",P+=u(1,12).filter(t=>s[t-1].includes("F")&&t!=D).splice(-1)[0]+"+",P+=u(1,12).filter(t=>s[t-1].includes("M")&&t!=D).splice(-1)[0]+"+",O=h(O,P+=u(1,12).filter(t=>s[t-1].includes("R")&&t!=D).splice(-1)[0]));var K=g(F.concat(["B","N","R"]),r?3:0);for(K[0]="K",v=0;v<K.length;v++){var z=K[v];F.includes(z)&&F.length-("V"==z?2:1)<t+1&&(z=g(["B","N","R"].filter(t=>!K.includes(t)&&!K.includes(t+"\u0301")),1)[0]),p(F,z),K[v]=Object(c.c)(z),o=h(o,K[v]+": "+this.rootlogService.getFactionProperName(K[v]).split(",")[v+t+e>4?1:0]+" "+(v+t+e>4?"\u25bc":"\u25b2"))}for(v=0;v<K.length&&v<5-t-e;v++){var B=K[v];if(B==Object(c.c)("K")){var H=g(u(1,12).filter(t=>c.l[l][t].slots>0&&t!=D),1)[0];O=h(O,Object(c.c)("K")+":b+2w->"+H.toString()),c.l[l][H].slots=c.l[l][H].slots-1}if(B==Object(c.c)("B")&&(R=g(u(1,12).filter(t=>t!=D),2),O=h(O,Object(c.c)("B")+":w->"+R[0].toString()+"+"+R[1].toString())),B==Object(c.c)("N")){if(P="",(R=g(Object.keys(c.m[l]),2)).length>0){P+=Object(c.c)("N")+":w->"+R[0];for(var q=1;q<R.length;q++)P+="+"+R[q]}O=h(O,P)}if(B==Object(c.c)("P")){var A=g(["R","F","M"],1)[0];R=g(u(1,12).filter(t=>s[t-1].includes(A)&&t!=D),2),O=h(O,Object(c.c)("P")+":w->"+R[0].toString()+"+"+R[1].toString())}if(B==Object(c.c)("L")){for(P="",(W=u(1,12).filter(t=>c.l[l][t].ruins&&t!=D)).length>0&&(P+=Object(c.c)("L")+":w->"+W[0]),q=1;q<W.length;q++)P+="+"+W[q];O=h(O,P)}if(B==Object(c.c)("D")&&(H=g(u(1,12).filter(t=>t!=D),1)[0],O=h(O,Object(c.c)("D")+":t+3w->"+H.toString())),B==Object(c.c)("E")&&(H=g(u(1,12).filter(t=>c.l[l][t].edge&&t!=D),1)[0],O=h(O,Object(c.c)("E")+":5w->"+H.toString())),B==Object(c.c)("C")){var W;if(P="",(W=u(1,12).filter(t=>t!=D)).length>0)for(P+=Object(c.c)("C")+":w->"+W[0],q=1;q<W.length;q++)P+="+"+W[q];O=h(O,P)}if(B==Object(c.c)("R")&&(H=g(u(1,12).filter(t=>t!=D),1)[0],O=h(O,Object(c.c)("R")+":w->"+H.toString())),B==Object(c.c)("H")){var T=g(u(1,12).filter(t=>t!=D),1)[0],X=g(u(1,12).filter(t=>t!=D),1)[0];O=h(O,Object(c.c)("H")+":w->"+T.toString()+"+"+X.toString())}if(B==Object(c.c)("O")&&(0==(R=g(u(1,12).filter(t=>c.l[l][t].edge&&c.l[l][t].river&&t!=D),1)).length&&(R=g(u(1,12).filter(t=>c.l[l][t].river&&t!=D),1)),H=R[0],O=h(O,Object(c.c)("O")+":w->"+H.toString())),B==Object(c.c)("V")&&(H=g(Object.keys(c.j[l]),1)[0],O=h(O,Object(c.c)("V")+":w->"+H.toString())),B==Object(c.c)("A")){var Y=g(["R","F","M"],1)[0],Q=g(["R","F","M"],1)[0];T=g(u(1,12).filter(t=>s[t-1].includes(Y)&&t!=D),1)[0],X=g(u(1,12).filter(t=>s[t-1].includes(Q)&&t!=D),1)[0],O=h(O,Object(c.c)("A")+":w->"+T.toString()+"+"+X.toString())}}for(var $=["D","E","C","K","H"],tt=!1,et=0,rt=$;!tt&&et<=1e5;)tt=!0,rt=f(F,t),((nt=$.filter(t=>rt.includes(t)||L.includes(t.toLowerCase())).length)<1||2==t&&nt<3)&&(tt=!1),et+=1;et>=1e5&&console.log("looped too much");var nt=$.filter(t=>rt.includes(t)||L.includes(t.toLowerCase())).length;for(v=0;v<rt.length;v++){if(P=rt[v]+": "+this.rootlogService.getFactionProperName(rt[v]),(v==rt.length-1&&nt<=1&&!$.includes(rt[v])&&!["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"].includes(rt[v])||v==rt.length-2&&nt<=1&&("V"==rt[v]||"G"==rt[v]))&&(P+=" \ud83d\udd12"),"K"==rt[v]){var ot=Object.keys(c.j[l]),lt="";if((R=g(["t","t","t","t","t_k","t_k","t_k","t_k","t_m","t_m","t_m","t_m"],ot.length)).length>0)for(lt+="K:"+R[0]+"->"+ot[0],q=1;q<R.length;q++)lt+="/"+R[q]+"->"+ot[q];O=h(O,lt)}o=h(o,P)}return o+=O,(C>=1e5||et>=1e5)&&(o="error"),o="Map: Winter\r\n\r\nDeck: Standard\r\n\r\nClearings: F1, M2, M3, M4, F5, R6, F7, R8, F9, R10, M11, R12\r\n\r\nM: Standard Deck\r\n\r\nc: Mechanical Marquise 2.0 (Iron will)\r\n\r\n\u0113: Vault Keepers \u25b2\r\n\r\n\u0117: Riverfolk Flotilla \u25b2\r\n\r\n\u0110: Flame Bearers \u25b2\r\n\r\nP: Corvid Conspiracy\r\n\r\nD: Underground Duchy\r\n\r\nV: Vagabond\r\n\r\n\u1ea2: Ranger\r\n\r\nM:b->8/b_s->9/b_w->11/b_r->12/t_f->7/t_c->12\r\n\r\nc:t_k->2/w->2+1+2+3+5+6+7+8+9+10+11+12/b_r->6/b_s->7/b_w->12\r\n\r\n\u0113:b+2w->12\r\n\r\n\u0117:w->10\r\n\r\n\u0110:w->1+4\r\n",console.log(o),o}}return t.\u0275fac=function(e){return new(e||t)(i.Sb(s.a))},t.\u0275prov=i.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),v=(()=>{class t{constructor(){}setItem(t,e){localStorage.setItem(t,e)}getItem(t){return localStorage.getItem(t)}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=r("/t3+"),M=r("kmnG"),O=r("qFsG"),w=r("3Pt+"),j=r("bSwM"),_=r("bTqV");const y=function(){return["/"]},C=function(){return{standalone:!0}},R=function(){return["/full-game"]},k=[{path:"",component:(()=>{class t{constructor(t,e,r){this.mapService=t,this.rootlogService=e,this.localStorageService=r,this.players=null==this.localStorageService.getItem("players")?"4":this.localStorageService.getItem("players"),this.bots=null==this.localStorageService.getItem("bots")?"0":this.localStorageService.getItem("bots"),this.hirelings=null!=this.localStorageService.getItem("hirelings")&&JSON.parse(this.localStorageService.getItem("hirelings").toLowerCase()),this.balanced=null!=this.localStorageService.getItem("balanced")&&JSON.parse(this.localStorageService.getItem("balanced").toLowerCase()),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced),this.validRootlog=!0,this.gameUrl="",this.validRootlogUrl=!1}gameChange(){this.localStorageService.setItem("players",this.players),this.localStorageService.setItem("bots",this.bots),this.localStorageService.setItem("hirelings",this.hirelings),this.localStorageService.setItem("balanced",this.balanced),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced)}async gameUrlChange(){try{const t=await this.rootlogService.getGameStringFromURLPromise(this.gameUrl);this.validRootlogUrl=this.rootlogService.isValidGame(t)}catch(t){this.validRootlogUrl=!1}}getURLParams(){const t={};return this.game&&(t.game=this.getEncodedGame()),this.gameUrl&&(t.gameUrl=this.gameUrl),t}getEncodedGame(){return this.game?Object(l.compressToEncodedURIComponent)(this.game):""}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(m),i.Jb(s.a),i.Jb(v))},t.\u0275cmp=i.Db({type:t,selectors:[["app-input"]],decls:26,vars:14,consts:[["color","primary",3,"routerLink"],[1,"container"],[1,"row"],[1,"col"],["appearance","outline","color","accent"],["matInput","","placeholder","Enter # of players here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["matInput","","placeholder","Enter # of bots here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"ngModel","change","ngModelChange"],["mat-flat-button","","color","primary",3,"routerLink","queryParams","disabled"]],template:function(t,e){1&t&&(i.Ob(0,"mat-toolbar",0),i.Ob(1,"span"),i.sc(2,"Root Map Setup"),i.Nb(),i.Nb(),i.Ob(3,"div",1),i.Ob(4,"div",2),i.Ob(5,"div",3),i.Ob(6,"mat-form-field",4),i.Ob(7,"mat-label"),i.sc(8,"Players"),i.Nb(),i.Ob(9,"textarea",5),i.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.players=t}),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.Ob(10,"div",2),i.Ob(11,"div",3),i.Ob(12,"mat-form-field",4),i.Ob(13,"mat-label"),i.sc(14,"Bots"),i.Nb(),i.Ob(15,"textarea",6),i.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.bots=t}),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.Ob(16,"div",2),i.Ob(17,"div",3),i.Ob(18,"mat-checkbox",7),i.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.hirelings=t}),i.sc(19," Hirelings? "),i.Nb(),i.Nb(),i.Ob(20,"mat-checkbox",7),i.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.balanced=t}),i.sc(21," Balanced Clearings? "),i.Nb(),i.Nb(),i.Ob(22,"div",2),i.Ob(23,"div",3),i.Ob(24,"button",8),i.sc(25,"Generate Map"),i.Nb(),i.Nb(),i.Nb(),i.Nb()),2&t&&(i.ec("routerLink",i.fc(10,y)),i.zb(9),i.ec("ngModel",e.players)("ngModelOptions",i.fc(11,C)),i.zb(6),i.ec("ngModel",e.bots)("ngModelOptions",i.fc(12,C)),i.zb(3),i.ec("ngModel",e.hirelings),i.zb(2),i.ec("ngModel",e.balanced),i.zb(4),i.ec("routerLink",i.fc(13,R))("queryParams",e.getURLParams())("disabled",!e.validRootlog&&!e.validRootlogUrl))},directives:[S.a,o.c,M.b,M.e,O.a,w.b,w.h,w.j,j.a,_.a],styles:[".container[_ngcontent-%COMP%]{padding:10px}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-left:20%;margin-right:20%}button[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:20px}textarea[_ngcontent-%COMP%]{height:20px;max-height:20px}"]}),t})()}];let N=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)},imports:[[o.d.forChild(k)],o.d]}),t})();var I=r("d2mR");let P=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)},imports:[[n.c,w.d,N,I.a]]}),t})()}}]);