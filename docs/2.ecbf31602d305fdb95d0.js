(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{UYdf:function(t,e,n){"use strict";n.r(e),n.d(e,"InputModule",function(){return I});var r=n("ofXK"),o=n("tyNb"),i=n("6xEa"),l=n("fXoL"),a=n("UPMW"),c=n("BJvs"),s=n("HDMR");function g(t,e){return d(t).slice(0,e)}function h(t,e){return t+e+"\r\n"}function d(t){return null==t&&console.trace(),t.map(t=>({value:t,sort:Math.random()})).sort((t,e)=>t.sort-e.sort).map(({value:t})=>t)}function u(t,e){return Array.from({length:e},(e,n)=>n+t)}function f(t,e,n,r){var o=c.l[r][e];return!(n.includes(e)||"t"!=t&&n.some(t=>o.adjacent.includes(t))||"t"==t&&!o.ruins||"t_m"==t&&(1!=o.slots||o.ruins)||"t_c"==t&&!o.river||"t_f"==t&&!o.river||!("t_r"!=t||!o.edge&&o.adjacent.length>2))}function b(t,e){for(var n=["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"],r=[],o=JSON.parse(JSON.stringify(t)),i=0;i<Math.max(e+1,3);i++){var l=g(o,1)[0];if(r.push(l),o.splice(o.indexOf(l),1),"V"==l){o.push("G");var a=g(n,1)[0];r.push(a),n.splice(n.indexOf(a),1)}else"G"==l&&(a=g(n,1)[0],r.push(a),n.splice(n.indexOf(a),1))}return r}function p(t,e){t.includes(e)&&t.splice(t.indexOf(e),1)}let m=(()=>{class t{constructor(t){this.rootlogService=t}mapSetup(t,e,n,r){var o="";const i=g([a.RootMap.Fall,a.RootMap.Winter,a.RootMap.Lake,a.RootMap.Mountain],1)[0];o=h(o,"Map: "+i);var l=Math.random()<=.9?"E&P":"Standard";o=h(o,"Deck: "+l);var s=["R","R","R","R","F","F","F","F","M","M","M","M"];s=d(s);for(var m=!0;r&&m;){s=d(s),m=!1;for(var v=0;v<s.length;v++){var O=c.l[i][v+1].adjacent;if(i==a.RootMap.Mountain&&(O=O.concat(c.l[i][v+1].closedAdjacent)),O.some(t=>s[t-1]==s[v])){m=!0;break}}}var M="Clearings: "+s[0]+"1";for(v=1;v<s.length;v++)M+=", "+s[v]+(v+1).toString();o=h(o,M);var S="";o=h(o,"M: "+l+" Deck");var w=g(["t","t_m","t_c","t_f","t_k","t_r"],Math.round(Math.max(Math.min(function(t,e){const{z0:n}=function(){const t=Math.random(),e=Math.random();return{z0:Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e),z1:Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*e)}}();return.557*n+1.1}(),2),0))),j=Math.random();("Mountain"==i&&j<.4&&!w.includes("t")||"Lake"==i&&j<.4&&!w.includes("t_f"))&&(w[0]="Mountain"==i?"t":"t_f");for(var _=!1,C=[],y=0;!_&&y<=1e5;){C=[],_=!0,w=d(w);var k=g(u(1,12),w.length);for(v=0;v<w.length;v++){var N=k[v];j=Math.random(),"Mountain"==i&&j<.2&&(N=10),f(w[v],N,C,i)||(_=!1),C.push(N)}y+=1}y>=1e5&&console.log("looped too much");var P=u(1,12).filter(t=>c.l[i][t].ruins),R=["b","b_s","b_w","b_r"],I="M:";if(P.length>0)for(I+=R[0]+"->"+P[0]+"/",v=1;v<P.length;v++)I+=R[v]+"->"+P[v]+"/";if(w.length>0){for(v=0;v<C.length;v++)I+=w[v]+"->"+C[v].toString()+"/","t_c"==w[v]?s[C[v]-1]=s[C[v]-1]+"FRM".replace(s[C[v]-1],""):"t_r"==w[v]?c.l[i][C[v]].slots=c.l[i][C[v]].slots+1:"t_k"==w[v]&&(s[C[v]-1].includes("F")&&(I+="Z%s/Z%s/Z%x/Z%h/"),s[C[v]-1].includes("R")&&(I+="Z%b/Z%b/Z%t/Z%t/"),s[C[v]-1].includes("M")&&(I+="Z%f/Z%f/Z%c/Z%c/"));S=h(S,I=I.slice(0,-1))}var x=["P","L","D","E","C","O","V","A","K","H"],F=["c","e","a","v","p","d","o","l"],L=["\xe5","\u1ea3","\u1ea5","\u1ea7","\u1ea9","\u0203"],U=g(F,e);for(v=0;v<U.length;v++)p(x,U[v].toUpperCase()),"v"==U[v]&&U.splice(v+1,0,g(L,1)[0]),I=U[v]+": "+this.rootlogService.getFactionProperName(U[v]),F.includes(U[v])&&(I+=" ("+g(c.i[U[v].toUpperCase()],1)+")"),o=h(o,I);var G=u(1,12).filter(t=>c.l[i][t].corner),V=0;if(U.includes("c")){var Z=d(["b_s","b_r","b_w"]),E=g(G,1)[0];for(G.splice(G.indexOf(E),1),V=E,I="c:t_k->"+E.toString()+"/w->"+E.toString(),v=1;v<13;v++)c.l[i][E].opposite!=v&&(I+="+"+v.toString());var J=c.l[i][E].adjacent;for(J.length<Z.length&&(J=J.concat(Array(Z.length-J.length).fill(E))),v=0;v<Z.length;v++)I+="/"+Z[v]+"->"+J[v].toString(),c.l[i][J[v]].slots=c.l[i][J[v]].slots-1;S=h(S,I)}if(U.includes("e")&&(E=3==G.length?c.l[i][u(1,12).filter(t=>c.l[i][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),c.l[i][E].slots=c.l[i][E].slots-1,S=h(S,"e:b+6w->"+E.toString())),U.includes("v")){var z=Object.keys(c.j[i]).reduce((t,e)=>t>(e.match(/\_/g)||[]).length?t:(e.match(/\_/g)||[]).length,0);S=h(S,"v:p->"+g(Object.keys(c.j[i]).filter(t=>(t.match(/\_/g)||[]).length==z),1)[0].toString())}if(U.includes("l")){for(E=3==G.length?c.l[i][u(1,12).filter(t=>c.l[i][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),I="l:4w+b_"+s[E-1].toString()[0].toLowerCase()+"->"+E.toString(),v=0;v<c.l[i][E].adjacent.length;v++)I+="/w->"+c.l[i][E].adjacent[v].toString();c.l[i][E].slots=c.l[i][E].slots-1,S=h(S,I)}if(U.includes("o")){for(I="o:w->"+(T=u(1,12).filter(t=>c.l[i][t].river&&t!=V))[0],v=1;v<T.length;v++)I+="+"+T[v];S=h(S,I)}if(U.includes("d")){for(E=3==G.length?c.l[i][u(1,12).filter(t=>c.l[i][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),I="d:t->"+E.toString()+"/2w->"+E.toString(),v=0;v<c.l[i][E].adjacent.length;v++)I+="+"+c.l[i][E].adjacent[v].toString();S=h(S,I)}U.includes("p")&&(I="p:w->",I+=u(1,12).filter(t=>s[t-1].includes("F")&&t!=V).splice(-1)[0]+"+",I+=u(1,12).filter(t=>s[t-1].includes("M")&&t!=V).splice(-1)[0]+"+",S=h(S,I+=u(1,12).filter(t=>s[t-1].includes("R")&&t!=V).splice(-1)[0]));var D=g(x.concat(["B","N","R"]),n?3:0);for(v=0;v<D.length;v++){var H=D[v];x.includes(H)&&x.length-("V"==H?2:1)<t+1&&(H=g(["B","N","R"].filter(t=>!D.includes(t)&&!D.includes(t+"\u0301")),1)[0]),p(x,H),D[v]=Object(c.c)(H),o=h(o,D[v]+": "+this.rootlogService.getFactionProperName(D[v]).split(",")[v+t+e>4?1:0]+" "+(v+t+e>4?"\u25bc":"\u25b2"))}for(v=0;v<D.length&&v<5-t-e;v++){var B=D[v];if(B==Object(c.c)("K")){var K=g(u(1,12).filter(t=>c.l[i][t].slots>0&&t!=V),1)[0];S=h(S,Object(c.c)("K")+":b+2w->"+K.toString()),c.l[i][K].slots=c.l[i][K].slots-1}if(B==Object(c.c)("B")&&(k=g(u(1,12).filter(t=>t!=V),2),S=h(S,Object(c.c)("B")+":w->"+k[0].toString()+"+"+k[1].toString())),B==Object(c.c)("N")){if(I="",(k=g(Object.keys(c.m[i]),2)).length>0){I+=Object(c.c)("N")+":w->"+k[0];for(var q=1;q<k.length;q++)I+="+"+k[q]}S=h(S,I)}if(B==Object(c.c)("P")){var A=g(["R","F","M"],1)[0];k=g(u(1,12).filter(t=>s[t-1].includes(A)&&t!=V),2),S=h(S,Object(c.c)("P")+":w->"+k[0].toString()+"+"+k[1].toString())}if(B==Object(c.c)("L")){for(I="",(T=u(1,12).filter(t=>c.l[i][t].ruins&&t!=V)).length>0&&(I+=Object(c.c)("L")+":w->"+T[0]),q=1;q<T.length;q++)I+="+"+T[q];S=h(S,I)}if(B==Object(c.c)("D")&&(K=g(u(1,12).filter(t=>t!=V),1)[0],S=h(S,Object(c.c)("D")+":t+3w->"+K.toString())),B==Object(c.c)("E")&&(K=g(u(1,12).filter(t=>c.l[i][t].edge&&t!=V),1)[0],S=h(S,Object(c.c)("E")+":5w->"+K.toString())),B==Object(c.c)("C")){var T;if(I="",(T=u(1,12).filter(t=>t!=V)).length>0)for(I+=Object(c.c)("C")+":w->"+T[0],q=1;q<T.length;q++)I+="+"+T[q];S=h(S,I)}if(B==Object(c.c)("R")&&(K=g(u(1,12).filter(t=>t!=V),1)[0],S=h(S,Object(c.c)("R")+":w->"+K.toString())),B==Object(c.c)("H")){var W=g(u(1,12).filter(t=>t!=V),1)[0],X=g(u(1,12).filter(t=>t!=V),1)[0];S=h(S,Object(c.c)("H")+":w->"+W.toString()+"+"+X.toString())}if(B==Object(c.c)("O")&&(0==(k=g(u(1,12).filter(t=>c.l[i][t].edge&&c.l[i][t].river&&t!=V),1)).length&&(k=g(u(1,12).filter(t=>c.l[i][t].river&&t!=V),1)),K=k[0],S=h(S,Object(c.c)("O")+":w->"+K.toString())),B==Object(c.c)("V")&&(K=g(Object.keys(c.j[i]),1)[0],S=h(S,Object(c.c)("V")+":w->"+K.toString())),B==Object(c.c)("A")){var Y=g(["R","F","M"],1)[0],Q=g(["R","F","M"],1)[0];W=g(u(1,12).filter(t=>s[t-1].includes(Y)&&t!=V),1)[0],X=g(u(1,12).filter(t=>s[t-1].includes(Q)&&t!=V),1)[0],S=h(S,Object(c.c)("A")+":w->"+W.toString()+"+"+X.toString())}}for(var $=["D","E","C","K","H"],tt=!1,et=0,nt=$;!tt&&et<=1e5;)tt=!0,nt=b(x,t),((rt=$.filter(t=>nt.includes(t)||U.includes(t.toLowerCase())).length)<1||2==t&&rt<3)&&(tt=!1),et+=1;et>=1e5&&console.log("looped too much");var rt=$.filter(t=>nt.includes(t)||U.includes(t.toLowerCase())).length;for(v=0;v<nt.length;v++){if(I=nt[v]+": "+this.rootlogService.getFactionProperName(nt[v]),(v==nt.length-1&&rt<=1&&!$.includes(nt[v])&&!["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"].includes(nt[v])||v==nt.length-2&&rt<=1&&("V"==nt[v]||"G"==nt[v]))&&(I+=" \ud83d\udd12"),"K"==nt[v]){var ot=Object.keys(c.j[i]),it="";if((k=g(["t","t","t","t","t_k","t_k","t_k","t_k","t_m","t_m","t_m","t_m"],ot.length)).length>0)for(it+="K:"+k[0]+"->"+ot[0],q=1;q<k.length;q++)it+="/"+k[q]+"->"+ot[q];S=h(S,it)}o=h(o,I)}return o+=S,(y>=1e5||et>=1e5)&&(o="error"),o}}return t.\u0275fac=function(e){return new(e||t)(l.Sb(s.a))},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),v=(()=>{class t{constructor(){}setItem(t,e){localStorage.setItem(t,e)}getItem(t){return localStorage.getItem(t)}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var O=n("/t3+"),M=n("kmnG"),S=n("qFsG"),w=n("3Pt+"),j=n("bSwM"),_=n("bTqV");const C=function(){return["/"]},y=function(){return{standalone:!0}},k=function(){return["/full-game"]},N=[{path:"",component:(()=>{class t{constructor(t,e,n){this.mapService=t,this.rootlogService=e,this.localStorageService=n,this.players=null==this.localStorageService.getItem("players")?"4":this.localStorageService.getItem("players"),this.bots=null==this.localStorageService.getItem("bots")?"0":this.localStorageService.getItem("bots"),this.hirelings=null!=this.localStorageService.getItem("hirelings")&&JSON.parse(this.localStorageService.getItem("hirelings").toLowerCase()),this.balanced=null!=this.localStorageService.getItem("balanced")&&JSON.parse(this.localStorageService.getItem("balanced").toLowerCase()),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced),this.validRootlog=!0,this.gameUrl="",this.validRootlogUrl=!1}gameChange(){this.localStorageService.setItem("players",this.players),this.localStorageService.setItem("bots",this.bots),this.localStorageService.setItem("hirelings",this.hirelings),this.localStorageService.setItem("balanced",this.balanced),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced)}async gameUrlChange(){try{const t=await this.rootlogService.getGameStringFromURLPromise(this.gameUrl);this.validRootlogUrl=this.rootlogService.isValidGame(t)}catch(t){this.validRootlogUrl=!1}}getURLParams(){const t={};return this.game&&(t.game=this.getEncodedGame()),this.gameUrl&&(t.gameUrl=this.gameUrl),t}getEncodedGame(){return this.game?Object(i.compressToEncodedURIComponent)(this.game):""}}return t.\u0275fac=function(e){return new(e||t)(l.Jb(m),l.Jb(s.a),l.Jb(v))},t.\u0275cmp=l.Db({type:t,selectors:[["app-input"]],decls:27,vars:14,consts:[["color","primary",3,"routerLink"],[1,"container"],[1,"row"],[1,"col"],["appearance","outline","color","accent"],["matInput","","placeholder","Enter # of players here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["matInput","","placeholder","Enter # of bots here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[1,"row-check"],[1,"row-col"],[3,"ngModel","change","ngModelChange"],["mat-flat-button","","color","primary",3,"routerLink","queryParams","disabled"]],template:function(t,e){1&t&&(l.Ob(0,"mat-toolbar",0),l.Ob(1,"span"),l.sc(2,"Root Map Setup"),l.Nb(),l.Nb(),l.Ob(3,"div",1),l.Ob(4,"div",2),l.Ob(5,"div",3),l.Ob(6,"mat-form-field",4),l.Ob(7,"mat-label"),l.sc(8,"Players"),l.Nb(),l.Ob(9,"textarea",5),l.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.players=t}),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(10,"div",2),l.Ob(11,"div",3),l.Ob(12,"mat-form-field",4),l.Ob(13,"mat-label"),l.sc(14,"Bots"),l.Nb(),l.Ob(15,"textarea",6),l.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.bots=t}),l.Nb(),l.Nb(),l.Nb(),l.Nb(),l.Ob(16,"div",7),l.Ob(17,"div",8),l.Ob(18,"mat-checkbox",9),l.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.hirelings=t}),l.sc(19," Hirelings? "),l.Nb(),l.Nb(),l.Ob(20,"div",8),l.Ob(21,"mat-checkbox",9),l.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.balanced=t}),l.sc(22," Balanced Clearings? "),l.Nb(),l.Nb(),l.Nb(),l.Ob(23,"div",2),l.Ob(24,"div",3),l.Ob(25,"button",10),l.sc(26,"Generate Map"),l.Nb(),l.Nb(),l.Nb(),l.Nb()),2&t&&(l.ec("routerLink",l.fc(10,C)),l.zb(9),l.ec("ngModel",e.players)("ngModelOptions",l.fc(11,y)),l.zb(6),l.ec("ngModel",e.bots)("ngModelOptions",l.fc(12,y)),l.zb(3),l.ec("ngModel",e.hirelings),l.zb(3),l.ec("ngModel",e.balanced),l.zb(4),l.ec("routerLink",l.fc(13,k))("queryParams",e.getURLParams())("disabled",!e.validRootlog&&!e.validRootlogUrl))},directives:[O.a,o.c,M.b,M.e,S.a,w.b,w.h,w.j,j.a,_.a],styles:[".container[_ngcontent-%COMP%]{padding:10px}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .row-check[_ngcontent-%COMP%]{margin-left:20%;margin-right:20%}.container[_ngcontent-%COMP%]   .row-check[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-between}.container[_ngcontent-%COMP%]   .row-check[_ngcontent-%COMP%]   .row-col[_ngcontent-%COMP%]{min-width:100px}button[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%], .row-check[_ngcontent-%COMP%]{margin-top:20px}textarea[_ngcontent-%COMP%]{height:20px;max-height:20px}"]}),t})()}];let P=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(e){return new(e||t)},imports:[[o.d.forChild(N)],o.d]}),t})();var R=n("d2mR");let I=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(e){return new(e||t)},imports:[[r.c,w.d,P,R.a]]}),t})()}}]);