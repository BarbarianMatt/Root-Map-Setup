(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{UYdf:function(t,e,r){"use strict";r.r(e),r.d(e,"InputModule",function(){return P});var n=r("ofXK"),o=r("tyNb"),l=r("6xEa"),i=r("fXoL"),a=r("UPMW"),c=r("BJvs"),s=r("HDMR");function g(t,e){return u(t).slice(0,e)}function h(t,e){return t+e+"\r\n"}function u(t){return null==t&&console.trace(),t.map(t=>({value:t,sort:Math.random()})).sort((t,e)=>t.sort-e.sort).map(({value:t})=>t)}function d(t,e){return Array.from({length:e},(e,r)=>r+t)}function b(t,e,r,n){var o=c.l[n][e];return!(r.includes(e)||"t"!=t&&r.some(t=>o.adjacent.includes(t))||"t"==t&&!o.ruins||"t_m"==t&&(1!=o.slots||o.ruins)||"t_c"==t&&!o.river||"t_f"==t&&!o.river||!("t_r"!=t||!o.edge&&o.adjacent.length>2))}function f(t,e){for(var r=["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"],n=[],o=JSON.parse(JSON.stringify(t)),l=0;l<Math.max(e+1,3);l++){var i=g(o,1)[0];if(n.push(i),o.splice(o.indexOf(i),1),"V"==i){o.push("G");var a=g(r,1)[0];n.push(a),r.splice(r.indexOf(a),1)}else"G"==i&&(a=g(r,1)[0],n.push(a),r.splice(r.indexOf(a),1))}return n}function p(t,e){t.includes(e)&&t.splice(t.indexOf(e),1)}let m=(()=>{class t{constructor(t){this.rootlogService=t}mapSetup(t,e,r,n){var o="";const l=g([a.RootMap.Fall,a.RootMap.Winter,a.RootMap.Lake,a.RootMap.Mountain],1)[0];o=h(o,"Map: "+l);var i=Math.random()<=.9?"E&P":"Standard";o=h(o,"Deck: "+i);var s=["R","R","R","R","F","F","F","F","M","M","M","M"];s=u(s);for(var m=!0;n&&m;){s=u(s),m=!1;for(var v=0;v<s.length;v++){var S=c.l[l][v+1].adjacent;if(l==a.RootMap.Mountain&&(S=S.concat(c.l[l][v+1].closedAdjacent)),S.some(t=>s[t-1]==s[v])){m=!0;break}}}var O="Clearings: "+s[0]+"1";for(v=1;v<s.length;v++)O+=", "+s[v]+(v+1).toString();o=h(o,O);var M="";o=h(o,"M: "+i+" Deck");var j=g(["t","t_m","t_c","t_f","t_k","t_r"],Math.round(Math.max(Math.min(function(t,e){const{z0:r}=function(){const t=Math.random(),e=Math.random();return{z0:Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e),z1:Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*e)}}();return.557*r+1.1}(),2),0))),w=Math.random();("Mountain"==l&&w<.4&&!j.includes("t")||"Lake"==l&&w<.4&&!j.includes("t_f"))&&(j[0]="Mountain"==l?"t":"t_f");for(var _=!1,y=[],C=0;!_&&C<=1e5;){y=[],_=!0,j=u(j);var k=g(d(1,12),j.length);for(v=0;v<j.length;v++){var N=k[v];w=Math.random(),"Mountain"==l&&w<.2&&(N=10),b(j[v],N,y,l)||(_=!1),y.push(N)}C+=1}C>=1e5&&console.log("looped too much");var R=d(1,12).filter(t=>c.l[l][t].ruins),I=["b","b_s","b_w","b_r"],P="M:";if(R.length>0)for(P+=I[0]+"->"+R[0]+"/",v=1;v<R.length;v++)P+=I[v]+"->"+R[v]+"/";if(j.length>0){for(v=0;v<y.length;v++)P+=j[v]+"->"+y[v].toString()+"/","t_c"==j[v]?s[y[v]-1]=s[y[v]-1]+"FRM".replace(s[y[v]-1],""):"t_r"==j[v]?c.l[l][y[v]].slots=c.l[l][y[v]].slots+1:"t_k"==j[v]&&(s[y[v]-1].includes("F")&&(P+="Z%s/Z%s/Z%x/Z%h/"),s[y[v]-1].includes("R")&&(P+="Z%b/Z%b/Z%t/Z%t/"),s[y[v]-1].includes("M")&&(P+="Z%f/Z%f/Z%c/Z%c/"));M=h(M,P=P.slice(0,-1))}var x=["P","L","D","E","C","O","V","A","K","H"],F=["c","e","a","v","p","d","o","l"],L=["\xe5","\u1ea3","\u1ea5","\u1ea7","\u1ea9","\u0203"],U=g(F,e);for(v=0;v<U.length;v++)p(x,U[v].toUpperCase()),"v"==U[v]&&U.splice(v+1,0,g(L,1)[0]),P=U[v]+": "+this.rootlogService.getFactionProperName(U[v]),F.includes(U[v])&&(P+=" ("+g(c.i[U[v].toUpperCase()],1)+")"),o=h(o,P);var G=d(1,12).filter(t=>c.l[l][t].corner),V=0;if(U.includes("c")){var Z=u(["b_s","b_r","b_w"]),E=g(G,1)[0];for(G.splice(G.indexOf(E),1),V=E,P="c:t_k->"+E.toString()+"/w->"+E.toString(),v=1;v<13;v++)c.l[l][E].opposite!=v&&(P+="+"+v.toString());var J=c.l[l][E].adjacent;for(J.length<Z.length&&(J=J.concat(Array(Z.length-J.length).fill(E))),v=0;v<Z.length;v++)P+="/"+Z[v]+"->"+J[v].toString(),c.l[l][J[v]].slots=c.l[l][J[v]].slots-1;M=h(M,P)}if(U.includes("e")&&(E=3==G.length?c.l[l][d(1,12).filter(t=>c.l[l][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),c.l[l][E].slots=c.l[l][E].slots-1,M=h(M,"e:b+6w->"+E.toString())),U.includes("v")){var z=Object.keys(c.j[l]).reduce((t,e)=>t>(e.match(/\_/g)||[]).length?t:(e.match(/\_/g)||[]).length,0);M=h(M,"v:p->"+g(Object.keys(c.j[l]).filter(t=>(t.match(/\_/g)||[]).length==z),1)[0].toString())}if(U.includes("l")){for(E=3==G.length?c.l[l][d(1,12).filter(t=>c.l[l][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),P="l:4w+b_"+s[E-1].toString()[0].toLowerCase()+"->"+E.toString(),v=0;v<c.l[l][E].adjacent.length;v++)P+="/w->"+c.l[l][E].adjacent[v].toString();c.l[l][E].slots=c.l[l][E].slots-1,M=h(M,P)}if(U.includes("o")){for(P="o:w->"+(T=d(1,12).filter(t=>c.l[l][t].river&&t!=V))[0],v=1;v<T.length;v++)P+="+"+T[v];M=h(M,P)}if(U.includes("d")){for(E=3==G.length?c.l[l][d(1,12).filter(t=>c.l[l][t].corner&&!G.includes(t))[0]].opposite:g(G,1)[0],G.splice(G.indexOf(E),1),P="d:t->"+E.toString()+"/2w->"+E.toString(),v=0;v<c.l[l][E].adjacent.length;v++)P+="+"+c.l[l][E].adjacent[v].toString();M=h(M,P)}U.includes("p")&&(P="p:w->",P+=d(1,12).filter(t=>s[t-1].includes("F")&&t!=V).splice(-1)[0]+"+",P+=d(1,12).filter(t=>s[t-1].includes("M")&&t!=V).splice(-1)[0]+"+",M=h(M,P+=d(1,12).filter(t=>s[t-1].includes("R")&&t!=V).splice(-1)[0]));var D=g(x.concat(["B","N","R"]),r?3:0);for(v=0;v<D.length;v++){var H=D[v];x.includes(H)&&x.length-("V"==H?2:1)<t+1&&(H=g(["B","N","R"].filter(t=>!D.includes(t)&&!D.includes(t+"\u0301")),1)[0]),p(x,H),D[v]=Object(c.c)(H),o=h(o,D[v]+": "+this.rootlogService.getFactionProperName(D[v]).split(",")[v+t+e>4?1:0]+" "+(v+t+e>4?"\u25bc":"\u25b2"))}for(v=0;v<D.length&&v<5-t-e;v++){var B=D[v];if(B==Object(c.c)("K")){var K=g(d(1,12).filter(t=>c.l[l][t].slots>0&&t!=V),1)[0];M=h(M,Object(c.c)("K")+":b+2w->"+K.toString()),c.l[l][K].slots=c.l[l][K].slots-1}if(B==Object(c.c)("B")&&(k=g(d(1,12).filter(t=>t!=V),2),M=h(M,Object(c.c)("B")+":w->"+k[0].toString()+"+"+k[1].toString())),B==Object(c.c)("N")){if(P="",(k=g(Object.keys(c.m[l]),2)).length>0){P+=Object(c.c)("N")+":w->"+k[0];for(var q=1;q<k.length;q++)P+="+"+k[q]}M=h(M,P)}if(B==Object(c.c)("P")){var A=g(["R","F","M"],1)[0];k=g(d(1,12).filter(t=>s[t-1].includes(A)&&t!=V),2),M=h(M,Object(c.c)("P")+":w->"+k[0].toString()+"+"+k[1].toString())}if(B==Object(c.c)("L")){for(P="",(T=d(1,12).filter(t=>c.l[l][t].ruins&&t!=V)).length>0&&(P+=Object(c.c)("L")+":w->"+T[0]),q=1;q<T.length;q++)P+="+"+T[q];M=h(M,P)}if(B==Object(c.c)("D")&&(K=g(d(1,12).filter(t=>t!=V),1)[0],M=h(M,Object(c.c)("D")+":t+3w->"+K.toString())),B==Object(c.c)("E")&&(K=g(d(1,12).filter(t=>c.l[l][t].edge&&t!=V),1)[0],M=h(M,Object(c.c)("E")+":5w->"+K.toString())),B==Object(c.c)("C")){var T;if(P="",(T=d(1,12).filter(t=>t!=V)).length>0)for(P+=Object(c.c)("C")+":w->"+T[0],q=1;q<T.length;q++)P+="+"+T[q];M=h(M,P)}if(B==Object(c.c)("R")&&(K=g(d(1,12).filter(t=>t!=V),1)[0],M=h(M,Object(c.c)("R")+":w->"+K.toString())),B==Object(c.c)("H")){var W=g(d(1,12).filter(t=>t!=V),1)[0],X=g(d(1,12).filter(t=>t!=V),1)[0];M=h(M,Object(c.c)("H")+":w->"+W.toString()+"+"+X.toString())}if(B==Object(c.c)("O")&&(0==(k=g(d(1,12).filter(t=>c.l[l][t].edge&&c.l[l][t].river&&t!=V),1)).length&&(k=g(d(1,12).filter(t=>c.l[l][t].river&&t!=V),1)),K=k[0],M=h(M,Object(c.c)("O")+":w->"+K.toString())),B==Object(c.c)("V")&&(K=g(Object.keys(c.j[l]),1)[0],M=h(M,Object(c.c)("V")+":w->"+K.toString())),B==Object(c.c)("A")){var Y=g(["R","F","M"],1)[0],Q=g(["R","F","M"],1)[0];W=g(d(1,12).filter(t=>s[t-1].includes(Y)&&t!=V),1)[0],X=g(d(1,12).filter(t=>s[t-1].includes(Q)&&t!=V),1)[0],M=h(M,Object(c.c)("A")+":w->"+W.toString()+"+"+X.toString())}}for(var $=["D","E","C","K","H"],tt=!1,et=0,rt=$;!tt&&et<=1e5;)tt=!0,rt=f(x,t),((nt=$.filter(t=>rt.includes(t)||U.includes(t.toLowerCase())).length)<1||2==t&&nt<3)&&(tt=!1),et+=1;et>=1e5&&console.log("looped too much");var nt=$.filter(t=>rt.includes(t)||U.includes(t.toLowerCase())).length;for(v=0;v<rt.length;v++){if(P=rt[v]+": "+this.rootlogService.getFactionProperName(rt[v]),(v==rt.length-1&&nt<=1&&!$.includes(rt[v])&&!["\u1ea0","\xc5","\xc4","\u1ea2","\u1e00","\u1ea4","\u1ea6","\u1ea8","\u0202"].includes(rt[v])||v==rt.length-2&&nt<=1&&("V"==rt[v]||"G"==rt[v]))&&(P+=" \ud83d\udd12"),"K"==rt[v]){var ot=Object.keys(c.j[l]),lt="";if((k=g(["t","t","t","t","t_k","t_k","t_k","t_k","t_m","t_m","t_m","t_m"],ot.length)).length>0)for(lt+="K:"+k[0]+"->"+ot[0],q=1;q<k.length;q++)lt+="/"+k[q]+"->"+ot[q];M=h(M,lt)}o=h(o,P)}return o+=M,(C>=1e5||et>=1e5)&&(o="error"),o}}return t.\u0275fac=function(e){return new(e||t)(i.Sb(s.a))},t.\u0275prov=i.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),v=(()=>{class t{constructor(){}setItem(t,e){localStorage.setItem(t,e)}getItem(t){return localStorage.getItem(t)}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=r("/t3+"),O=r("kmnG"),M=r("qFsG"),j=r("3Pt+"),w=r("bSwM"),_=r("bTqV");const y=function(){return["/"]},C=function(){return{standalone:!0}},k=function(){return["/full-game"]},N=[{path:"",component:(()=>{class t{constructor(t,e,r){this.mapService=t,this.rootlogService=e,this.localStorageService=r,this.players=null==this.localStorageService.getItem("players")?"4":this.localStorageService.getItem("players"),this.bots=null==this.localStorageService.getItem("bots")?"0":this.localStorageService.getItem("bots"),this.hirelings=null!=this.localStorageService.getItem("hirelings")&&JSON.parse(this.localStorageService.getItem("hirelings").toLowerCase()),this.balanced=null!=this.localStorageService.getItem("balanced")&&JSON.parse(this.localStorageService.getItem("balanced").toLowerCase()),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced),this.validRootlog=!0,this.gameUrl="",this.validRootlogUrl=!1}gameChange(){this.localStorageService.setItem("players",this.players),this.localStorageService.setItem("bots",this.bots),this.localStorageService.setItem("hirelings",this.hirelings),this.localStorageService.setItem("balanced",this.balanced),this.game=this.mapService.mapSetup(parseInt(this.players),parseInt(this.bots),this.hirelings,this.balanced)}async gameUrlChange(){try{const t=await this.rootlogService.getGameStringFromURLPromise(this.gameUrl);this.validRootlogUrl=this.rootlogService.isValidGame(t)}catch(t){this.validRootlogUrl=!1}}getURLParams(){const t={};return this.game&&(t.game=this.getEncodedGame()),this.gameUrl&&(t.gameUrl=this.gameUrl),t}getEncodedGame(){return this.game?Object(l.compressToEncodedURIComponent)(this.game):""}}return t.\u0275fac=function(e){return new(e||t)(i.Jb(m),i.Jb(s.a),i.Jb(v))},t.\u0275cmp=i.Db({type:t,selectors:[["app-input"]],decls:26,vars:14,consts:[["color","primary",3,"routerLink"],[1,"container"],[1,"row"],[1,"col"],["appearance","outline","color","accent"],["matInput","","placeholder","Enter # of players here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["matInput","","placeholder","Enter # of bots here...",1,"input-game",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"ngModel","change","ngModelChange"],["mat-flat-button","","color","primary",3,"routerLink","queryParams","disabled"]],template:function(t,e){1&t&&(i.Ob(0,"mat-toolbar",0),i.Ob(1,"span"),i.sc(2,"Root Map Setup"),i.Nb(),i.Nb(),i.Ob(3,"div",1),i.Ob(4,"div",2),i.Ob(5,"div",3),i.Ob(6,"mat-form-field",4),i.Ob(7,"mat-label"),i.sc(8,"Players"),i.Nb(),i.Ob(9,"textarea",5),i.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.players=t}),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.Ob(10,"div",2),i.Ob(11,"div",3),i.Ob(12,"mat-form-field",4),i.Ob(13,"mat-label"),i.sc(14,"Bots"),i.Nb(),i.Ob(15,"textarea",6),i.Vb("keyup",function(){return e.gameChange()})("ngModelChange",function(t){return e.bots=t}),i.Nb(),i.Nb(),i.Nb(),i.Nb(),i.Ob(16,"div",2),i.Ob(17,"div",3),i.Ob(18,"mat-checkbox",7),i.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.hirelings=t}),i.sc(19," Hirelings? "),i.Nb(),i.Nb(),i.Ob(20,"mat-checkbox",7),i.Vb("change",function(){return e.gameChange()})("ngModelChange",function(t){return e.balanced=t}),i.sc(21," Balanced Clearings? "),i.Nb(),i.Nb(),i.Ob(22,"div",2),i.Ob(23,"div",3),i.Ob(24,"button",8),i.sc(25,"Generate Map"),i.Nb(),i.Nb(),i.Nb(),i.Nb()),2&t&&(i.ec("routerLink",i.fc(10,y)),i.zb(9),i.ec("ngModel",e.players)("ngModelOptions",i.fc(11,C)),i.zb(6),i.ec("ngModel",e.bots)("ngModelOptions",i.fc(12,C)),i.zb(3),i.ec("ngModel",e.hirelings),i.zb(2),i.ec("ngModel",e.balanced),i.zb(4),i.ec("routerLink",i.fc(13,k))("queryParams",e.getURLParams())("disabled",!e.validRootlog&&!e.validRootlogUrl))},directives:[S.a,o.c,O.b,O.e,M.a,j.b,j.h,j.j,w.a,_.a],styles:[".container[_ngcontent-%COMP%]{padding:10px}.container[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{margin-left:20%;margin-right:20%}button[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%]{width:100%}.row[_ngcontent-%COMP%]{margin-top:20px}textarea[_ngcontent-%COMP%]{height:20px;max-height:20px}"]}),t})()}];let R=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)},imports:[[o.d.forChild(N)],o.d]}),t})();var I=r("d2mR");let P=(()=>{class t{}return t.\u0275mod=i.Hb({type:t}),t.\u0275inj=i.Gb({factory:function(e){return new(e||t)},imports:[[n.c,j.d,R,I.a]]}),t})()}}]);